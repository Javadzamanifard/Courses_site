{% extends '_base.html' %}
{% load static humanize i18n%}
{% load ennum_to_fanum_tags %}

{% block title %}{% trans "Training courses" %}{% endblock %}

{% block CSS %}
    <link rel="stylesheet" href="{% static 'css/courses.css' %}">
{% endblock CSS %}
{% block content %}
<div class="container py-5">
  <h1 class="text-center mb-5 fw-bold" style="color: #2c3e50;">ðŸ“š{% trans "Training courses" %}</h1>

  <!-- Ù†ÙˆØ§Ø± ÙÛŒÙ„ØªØ± Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§ -->
  <div class="course-filter mb-4 d-flex gap-2 flex-wrap">
      <a href="{% url 'courses:course_list' %}" 
        class="filter-btn {% if not course_type %}filter-all{% else %}filter-outline{% endif %}">{% trans "Ù‡Ù…Ù‡ Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§" %}</a>
      <a href="{% url 'courses:course_list' %}?type=free" 
        class="filter-btn {% if course_type == 'free' %}filter-free{% else %}filter-outline{% endif %}">{% trans "Ø±Ø§ÛŒÚ¯Ø§Ù†" %}</a>
      <a href="{% url 'courses:course_list' %}?type=paid" 
        class="filter-btn {% if course_type == 'paid' %}filter-paid{% else %}filter-outline{% endif %}">{% trans "ÙˆÛŒÚ˜Ù‡" %}</a>
  </div>

  <div class="row g-4">
    {% for course in courses %}
    <div class="col-lg-4 col-md-6 col-sm-12">
      <div class="course-card shadow-sm">
        <div class="preview-container">
          {% if course.preview_video %}
            <video poster="{% if course.cover_image %}{{ course.cover_image.url }}{% endif %}" controls muted preload="none">
              <source src="{{ course.preview_video.url }}" type="video/mp4">
              {% trans "Your browser does not support video." %}
            </video>
            {% if course.is_free %}
              <div class="free-badge">{% trans "Free" %}</div>
            {% endif %}
          {% elif course.cover_image %}
            <img src="{{ course.cover_image.url }}" alt="{{ course.title }}">
            {% if course.is_free %}
              <div class="free-badge">{% trans "Free" %}</div>
            {% endif %}
          {% else %}
            <div class="placeholder-text">{% trans "There is no video or image available for this course." %}</div>
            {% if course.is_free %}
              <div class="free-badge">{% trans "Free" %}</div>
            {% endif %}
          {% endif %}
        </div>

        <div class="card-body d-flex flex-column p-4">
          <h5 class="course-title mb-3">{{ course.title }}</h5>
          <p class="text-muted mb-4 flex-grow-1" style="font-size: 0.95rem;">
            {{ course.short_description|truncatewords:20 }}
          </p>

          <div class="d-flex justify-content-between align-items-center mt-auto">
            {% if course.is_free %}
              <span class="text-success fw-bold">{% trans "Free" %}</span>
              <a href="#" class="btn btn-view btn-sm px-3 py-2">{% trans "View course" %}</a>
            {% else %}
                <span class="price-tag">
                    <span style="direction:ltr; unicode-bidi:bidi-override;">
                        {{ course.price|en2fa|intcomma:False }}
                    </span>
                    {% trans "ØªÙˆÙ…Ø§Ù†" %}
                </span>
              <a href="#" class="btn btn-cart btn-sm px-3 py-2">{% trans "Add to" %}</a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12 text-center py-5">
      <div class="alert alert-info rounded-3" style="max-width: 600px; margin: 0 auto;">
        <h4>{% trans "No course found." %}</h4>
        <p class="mb-0">{% trans "Unfortunately, no courses are currently available." %}</p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}